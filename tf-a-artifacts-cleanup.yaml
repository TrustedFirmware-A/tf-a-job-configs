- job:
    name: tf-a-artifacts-cleanup
    node: master
    project-type: freestyle
    concurrent: true
    disabled: false
    defaults: global
    description: |
      Gradually cleanup artifacts in TF-A builds
    properties:
        - build-discarder:
            days-to-keep: 50
            num-to-keep: 50
        - authorization:
            !include: authorization.yaml.inc
    triggers:
        - timed: 'H H/8 * * *'
    wrappers:
        - timestamps
    builders:
        - shell: |
            #!/bin/bash

            find /var/lib/jenkins/jobs/tf-a-builder/builds -name build.log -mtime +5 | head -n1000 | xargs -i -n1 bash -c "echo {}; gzip -9 {}"
