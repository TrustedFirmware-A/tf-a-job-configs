- job:
    name: tf-a-lts-release-docs
    node: docker-amd64-tf-a-jammy
    project-type: freestyle
    concurrent: true
    disabled: false
    description: |
      Publish TF-A LTS docs for a release on ReadTheDocs site
    properties:
      - build-discarder:
          days-to-keep: 365
          num-to-keep: 50
    parameters:
      - string:
          name: GERRIT_HOST
          default: review.trustedfirmware.org
      - string:
          name: GERRIT_PROJECT
          default: sandbox/pfalcon/trusted-firmware-a
          description: |
            TF-A Git project
      - string:
          name: GERRIT_BRANCH
          default: ""
          description: |
            Git branch (e.g. lts-v2.8)
      - string:
          name: GERRIT_REFNAME
          default: ""
          description: |
            Git refname
      - string:
          name: RELEASE_TAG
          default: --latest
          description: |
            Release git tag, e.g. 'lts-v2.8.10'
      - bool:
          name: SANDBOX_RUN
          default: true
          description: |
            Run sandbox simulation of a release. Uncheck this only after
            running simulation and checking that everything is correct!
    wrappers:
      - timestamps
      - timeout:
          timeout: 60
          fail: true
      - credentials-binding:
          - text:
              credential-id: TF-A-RTD-API-TOKEN
              variable: RTD_API_TOKEN
          - text:
              credential-id: Trusted_Firmware_ReadTheDocs_Token
              variable: RTD_WEBHOOK_SECRET
          - text:
              credential-id: TFA_SANDBOX_RTD_WEBHOOK_SECRET
              variable: TFA_SANDBOX_RTD_WEBHOOK_SECRET
          - text:
              credential-id: PFALCON_RTD_API_TOKEN
              variable: PFALCON_RTD_API_TOKEN
          - text:
              credential-id: PFALCON_RTD_WEBHOOK_SECRET
              variable: PFALCON_RTD_WEBHOOK_SECRET
    builders:
      - shell: !include-raw-verbatim: scripts/tf-a-lts-docs-watcher.sh
